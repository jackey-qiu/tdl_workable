#!/usr/bin/python
##########################################################################
"""
  functions for atomic data, usually accessed by integer atomic number (z).  
  functions includes:
    symbol(z)      atomic symbol
    z(sym)      atomic Z from symbol
    weight(z)      atomic weight (amu)
    kedge(z)       K  edge energy (eV)
    l1edge(z)      L1 edge energy (eV)
    l2edge(z)      L2 edge energy (eV)
    l3edge(z)      L3 edge energy (eV)
    m1edge(z)      M1 edge energy (eV)
    m2edge(z)      M2 edge energy (eV)
    m3edge(z)      M3 edge energy (eV)
    m4edge(z)      M4 edge energy (eV)
    m5edge(z)      M5 edge energy (eV)
    n1edge(z)      N1 edge energy (eV)
    n2edge(z)      N2 edge energy (eV)
    n3edge(z)      N3 edge energy (eV)
    n4edge(z)      N4 edge energy (eV)
    n5edge(z)      N5 edge energy (eV)
    n6edge(z)      N6 edge energy (eV)
    n7edge(z)      N7 edge energy (eV)
    kwidth(z)      K  edge width (eV)
    l1width(z)     L1 edge width (eV)
    l2width(z)     L2 edge width (eV)
    l3width(z)     L3 edge width (eV)
    fluor_line(z,line)  emission line for char*8 line: 
        'kalpha'(='kalpha1'), 'kalpha2', 'kalpha3',
        'kbeta' (='kbeta1'),  'kbeta2', 'kbeta3', 'kbeta4', 'kbeta5',
        'lalpha'(='lalpha1'), 'lalpha2', 
        'lbeta' (='lbeta1'),  'lbeta2', 'lbeta3', 'lbeta4', 'lbeta6',
        'lgamma'(='lgamma1'), 'lgamma2', 'lgamma3'

//////////////////////////////////////////////////////////////////////
 Copyright (c) 2004 Matthew Newville, The University of Chicago

 Permission to use and redistribute the source code or binary forms of
 this software and its documentation, with or without modification is
 hereby granted provided that the above notice of copyright, these
 terms of use, and the disclaimer of warranty below appear in the
 source code and documentation, and that none of the names of The
 University of Chicago, The University of Washington, or the authors
 appear in advertising or endorsement of works derived from this
 software without specific prior written permission from all parties.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 SOFTWARE OR THE USE OR OTHER DEALINGS IN THIS SOFTWARE.
//////////////////////////////////////////////////////////////////////
"""
##########################################################################

import types
import numpy as num

##########################################################################

hbarc = 1973.26960 # hbar*c in eV*Angstroms
# could also computer here  hbarc=  299792458. * 1.e10* 1.054571596e-34 /1.602176462e-19
hc    = hbarc * 2 * num.pi

(SYMBOL,WEIGHT,KEDGE,L1EDGE,L2EDGE,L3EDGE,
 M1EDGE,M2EDGE,M3EDGE,M4EDGE,M5EDGE,
 N1EDGE,N2EDGE,N3EDGE,N4EDGE,N5EDGE,N6EDGE,N7EDGE,
 KWIDTH,L1WIDTH,L2WIDTH,L3WIDTH) = range(22)

_at_dat = (
    (None, 'H ', 'He', 'Li', 'Be', 'B ', 'C ', 'N ', 'O ', 'F ', 'Ne',
     'Na', 'Mg', 'Al', 'Si', 'P ', 'S ', 'Cl', 'Ar', 'K ', 'Ca', 'Sc',
     'Ti', 'V ', 'Cr', 'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga', 'Ge',
     'As', 'Se', 'Br', 'Kr', 'Rb', 'Sr', 'Y ', 'Zr', 'Nb', 'Mo', 'Tc',
     'Ru', 'Rh', 'Pd', 'Ag', 'Cd', 'In', 'Sn', 'Sb', 'Te', 'I ', 'Xe',
     'Cs', 'Ba', 'La', 'Ce', 'Pr', 'Nd', 'Pm', 'Sm', 'Eu', 'Gd', 'Tb',
     'Dy', 'Ho', 'Er', 'Tm', 'Yb', 'Lu', 'Hf', 'Ta', 'W ', 'Re', 'Os',
     'Ir', 'Pt', 'Au', 'Hg', 'Tl', 'Pb', 'Bi', 'Po', 'At', 'Rn', 'Fr',
     'Ra', 'Ac', 'Th', 'Pa', 'U ', 'Np', 'Pu', 'Am', 'Cm', 'Bk', 'Cf'),

    #weight
    (0, 1.0079, 4.0026, 6.941, 9.0122, 10.81, 12.011, 14.0067, 15.9994,
    18.9984, 20.179, 22.9898, 24.305, 26.9815, 28.0855, 30.9738, 32.06,
    35.453, 39.948, 39.0983, 40.08, 44.9559, 47.88, 50.9415, 51.996,
    54.938, 55.847, 58.9332, 58.69, 63.546, 65.38, 69.72, 72.59, 74.9216,
    78.96, 79.904, 83.8, 85.4678, 87.62, 88.9059, 91.22, 92.9064, 95.94,
    97.907, 101.07, 102.906, 106.42, 107.868, 112.41, 114.82, 118.69,
    121.75, 127.6, 126.905, 131.29, 132.905, 137.33, 138.906, 140.12,
    140.908, 144.24, 144.913, 150.36, 151.96, 157.25, 158.925, 162.5,
    164.93, 167.26, 168.934, 173.04, 174.967, 178.49, 180.948, 183.85,
    186.207, 190.2, 192.22, 195.08, 196.967, 200.59, 204.383, 207.2,
    208.98, 208.982, 209.987, 222.018, 223.02, 226.025, 227.028, 232.038,
    231.036, 238.051, 237.048, 239.052, 243.061, 247.07, 247.07, 251.08),

    #K-edge
    (0, 13.6, 24.6, 54.7, 111.5, 188.0, 284.2, 409.9, 543.1, 696.7, 870.2,
    1070.8, 1303.0, 1559.0, 1839.0, 2145.5, 2472.0, 2822.0, 3205.9, 3608.4,
    4038.5, 4492.0, 4966.0, 5465.0, 5989.0, 6539.0, 7112.0, 7709.0, 8333.0,
    8979.0, 9659.0, 10367.0, 11103.0, 11867.0, 12658.0, 13474.0, 14326.0,
    15200.0, 16105.0, 17038.0, 17998.0, 18986.0, 20000.0, 21044.0, 22117.0,
    23220.0, 24350.0, 25514.0, 26711.0, 27940.0, 29200.0, 30491.0, 31814.0,
    33169.0, 34561.0, 35985.0, 37441.0, 38925.0, 40443.0, 41991.0, 43569.0,
    45184.0, 46834.0, 48519.0, 50239.0, 51996.0, 53789.0, 55618.0, 57486.0,
    59390.0, 61332.0, 63314.0, 65351.0, 67416.0, 69525.0, 71676.0, 73871.0,
    76111.0, 78395.0, 80725.0, 83102.0, 85530.0, 88005.0, 90526.0, 93105.0,
    95730.0, 98404.0, 101137.0, 103922.0, 106755.0, 109651.0, 112601.0,
    115606.0, 118669.0, 121791.0, 124982.0, 128241.0, 131556.0, 134939.0),

    #L1-edge
    (0, 0.0, 0.0, 5.3, 8.0, 12.6, 18.0, 37.3, 41.6, 45.0, 48.5, 63.5, 88.6,
    117.8, 149.7, 189.0, 230.9, 270.0, 326.3, 378.6, 438.4, 498.0, 560.9,
    626.7, 696.0, 769.1, 844.6, 925.1, 1008.6, 1096.7, 1196.2, 1299.0,
    1414.6, 1527.0, 1652.0, 1782.0, 1921.0, 2065.0, 2216.0, 2373.0, 2532.0,
    2698.0, 2866.0, 3043.0, 3224.0, 3412.0, 3604.0, 3806.0, 4018.0, 4238.0,
    4465.0, 4698.0, 4939.0, 5188.0, 5453.0, 5714.0, 5989.0, 6266.0, 6548.0,
    6835.0, 7126.0, 7428.0, 7737.0, 8052.0, 8376.0, 8708.0, 9046.0, 9394.0,
    9751.0, 10116.0, 10486.0, 10870.0, 11271.0, 11682.0, 12100.0, 12527.0,
    12968.0, 13419.0, 13880.0, 14353.0, 14839.0, 15347.0, 15861.0, 16388.0,
    16939.0, 17493.0, 18049.0, 18639.0, 19237.0, 19840.0, 20472.0, 21105.0,
    21757.0, 22427.0, 23104.0, 23808.0, 24526.0, 25256.0, 26010.0),
    
    #L2-edge
    (0, 0.0, 0.0, 0.0, 3.0, 4.7, 7.2, 17.5, 18.2, 19.9, 21.7, 30.4, 49.6,
    72.9, 99.8, 136.0, 163.6, 202.0, 250.6, 297.3, 349.7, 403.6, 460.2,
    519.8, 583.8, 649.9, 719.9, 793.2, 870.0, 952.3, 1044.9, 1143.2,
    1248.1, 1359.1, 1474.3, 1596.0, 1730.9, 1864.0, 2007.0, 2156.0, 2307.0,
    2465.0, 2625.0, 2793.0, 2967.0, 3146.0, 3330.0, 3524.0, 3727.0, 3938.0,
    4156.0, 4380.0, 4612.0, 4852.0, 5107.0, 5359.0, 5624.0, 5891.0, 6164.0,
    6440.0, 6722.0, 7013.0, 7312.0, 7617.0, 7930.0, 8252.0, 8581.0, 8918.0,
    9264.0, 9617.0, 9978.0, 10349.0, 10739.0, 11136.0, 11544.0, 11959.0,
    12385.0, 12824.0, 13273.0, 13734.0, 14209.0, 14698.0, 15200.0, 15711.0,
    16244.0, 16785.0, 17337.0, 17907.0, 18484.0, 19083.0, 19693.0, 20314.0,
    20948.0, 21600.0, 22266.0, 22952.0, 23651.0, 24371.0, 25108.0),

    #l3-edge
    (0, 0.0, 0.0, 0.0, 3.0, 4.7, 7.2, 17.5, 18.2, 19.9, 21.6, 30.5, 49.2,
    72.5, 99.2, 135.0, 162.5, 200.0, 248.4, 294.6, 346.2, 398.7, 453.8,
    512.1, 574.1, 638.7, 706.8, 778.1, 852.7, 932.7, 1021.8, 1116.4,
    1217.0, 1323.6, 1433.9, 1550.0, 1678.4, 1804.0, 1940.0, 2080.0, 2223.0,
    2371.0, 2520.0, 2677.0, 2838.0, 3004.0, 3173.0, 3351.0, 3538.0, 3730.0,
    3929.0, 4132.0, 4341.0, 4557.0, 4786.0, 5012.0, 5247.0, 5483.0, 5723.0,
    5964.0, 6208.0, 6459.0, 6716.0, 6977.0, 7243.0, 7514.0, 7790.0, 8071.0,
    8358.0, 8648.0, 8944.0, 9244.0, 9561.0, 9881.0, 10207.0, 10535.0,
    10871.0, 11215.0, 11564.0, 11919.0, 12284.0, 12658.0, 13035.0, 13419.0,
    13814.0, 14214.0, 14619.0, 15031.0, 15444.0, 15871.0, 16300.0, 16733.0,
    17166.0, 17610.0, 18057.0, 18510.0, 18970.0, 19435.0, 19907.0),

    #m1-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0,
    8.0, 12.0, 14.0, 18.0, 29.3, 34.8, 44.3, 51.1, 58.7, 66.3, 74.1, 82.3,
    91.3, 101.0, 110.8, 122.5, 139.8, 159.5, 180.1, 204.7, 229.6, 257.0,
    292.8, 326.7, 358.7, 392.0, 430.3, 466.6, 506.3, 544.0, 586.1, 628.1,
    671.6, 719.0, 772.0, 827.2, 884.7, 940.0, 1006.0, 1072.0, 1148.7,
    1211.0, 1293.0, 1362.0, 1436.0, 1511.0, 1575.0, 1650.0, 1723.0, 1800.0,
    1881.0, 1968.0, 2047.0, 2128.0, 2206.0, 2307.0, 2398.0, 2491.0, 2601.0,
    2708.0, 2820.0, 2932.0, 3049.0, 3174.0, 3296.0, 3425.0, 3562.0, 3704.0,
    3851.0, 3999.0, 4149.0, 4317.0, 4482.0, 4652.0, 4822.0, 5002.0, 5182.0,
    5367.0, 5548.0, 5739.0, 5933.0, 6133.0, 6337.0, 6545.0, 6761.0),

    #m2-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0,
    2.0, 7.0, 8.0, 10.0, 15.9, 18.3, 25.4, 28.3, 32.6, 37.2, 42.2, 47.2,
    52.7, 58.9, 68.0, 77.3, 91.4, 103.5, 124.9, 146.2, 166.5, 189.0, 222.2,
    248.7, 280.3, 310.6, 343.5, 376.1, 411.6, 447.6, 483.3, 521.3, 559.9,
    603.8, 652.6, 703.2, 756.5, 812.7, 870.8, 931.0, 1002.1, 1071.0,
    1137.0, 1209.0, 1274.0, 1337.0, 1403.0, 1471.4, 1541.0, 1614.0, 1688.0,
    1768.0, 1842.0, 1923.0, 2006.0, 2090.0, 2173.0, 2264.0, 2365.0, 2469.0,
    2575.0, 2682.0, 2792.0, 2909.0, 3027.0, 3148.0, 3279.0, 3416.0, 3554.0,
    3696.0, 3854.0, 4008.0, 4159.0, 4327.0, 4490.0, 4656.0, 4830.0, 5001.0,
    5182.0, 5366.0, 5547.0, 5739.0, 5937.0, 6138.0, 6345.0),

    #m3-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0,
    2.0, 6.0, 7.0, 10.0, 15.7, 18.3, 25.4, 28.3, 32.6, 37.2, 42.2, 47.2,
    52.7, 59.9, 66.2, 75.1, 88.6, 100.0, 120.8, 141.2, 160.7, 182.0, 214.4,
    239.1, 270.0, 298.8, 329.8, 360.6, 394.0, 417.7, 461.5, 496.5, 532.3,
    573.0, 618.4, 665.3, 714.6, 766.4, 820.8, 875.0, 940.6, 1003.0, 1063.0,
    1128.0, 1187.0, 1242.0, 1297.0, 1357.0, 1419.8, 1481.0, 1544.0, 1611.0,
    1676.0, 1741.0, 1812.0, 1885.0, 1950.0, 2024.0, 2107.0, 2194.0, 2281.0,
    2367.0, 2457.0, 2551.0, 2645.0, 2743.0, 2847.0, 2957.0, 3066.0, 3177.0,
    3302.0, 3426.0, 3538.0, 3663.0, 3792.0, 3909.0, 4046.0, 4174.0, 4303.0,
    4435.0, 4563.0, 4698.0, 4838.0, 4976.0, 5116.0),

    #m4-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0,
    4.0, 5.0, 10.2, 18.7, 29.8, 41.7, 55.5, 70.0, 95.0, 113.0, 136.0,
    157.7, 181.1, 205.0, 231.1, 257.6, 284.2, 311.9, 340.5, 374.0, 411.9,
    451.4, 493.2, 537.5, 583.4, 630.8, 689.0, 740.5, 795.7, 853.0, 902.4,
    948.3, 1003.3, 1052.0, 1110.9, 1158.6, 1221.9, 1276.9, 1333.0, 1392.0,
    1453.0, 1515.0, 1576.0, 1639.0, 1716.0, 1793.0, 1872.0, 1949.0, 2031.0,
    2116.0, 2202.0, 2291.0, 2385.0, 2485.0, 2586.0, 2688.0, 2798.0, 2909.0,
    3022.0, 3136.0, 3248.0, 3370.0, 3491.0, 3611.0, 3728.0, 3849.0, 3970.0,
    4096.0, 4224.0, 4353.0, 4484.0),

    #m5-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0,
    4.0, 5.0, 10.1, 18.7, 29.2, 41.7, 54.6, 69.0, 93.8, 112.0, 134.2,
    155.8, 178.8, 202.3, 227.9, 253.9, 280.0, 307.2, 335.2, 368.3, 405.2,
    443.9, 484.9, 528.2, 573.0, 619.3, 676.4, 726.6, 780.5, 836.0, 883.8,
    928.8, 980.4, 1027.0, 1083.4, 1127.5, 1189.6, 1241.1, 1292.0, 1351.0,
    1409.0, 1468.0, 1528.0, 1589.0, 1662.0, 1735.0, 1809.0, 1883.0, 1960.0,
    2040.0, 2122.0, 2206.0, 2295.0, 2389.0, 2484.0, 2580.0, 2683.0, 2787.0,
    2892.0, 3000.0, 3105.0, 3219.0, 3332.0, 3442.0, 3552.0, 3664.0, 3775.0,
    3890.0, 4009.0, 4127.0, 4247.0),

    #N1 edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 1.0, 5.0, 8.0, 12.0, 27.0, 27.5, 30.5, 38.9, 43.8, 50.6,
    56.4, 63.2, 69.5, 75.0, 81.4, 87.1, 97.0, 109.8, 122.9, 137.1, 153.2,
    169.4, 186.0, 213.2, 232.3, 253.5, 274.7, 291.0, 304.5, 319.2, 331.0,
    347.2, 360.0, 378.6, 396.0, 414.2, 432.4, 449.8, 470.9, 480.5, 506.8,
    538.0, 563.4, 594.1, 625.4, 658.2, 691.1, 725.4, 762.1, 802.2, 846.2,
    891.8, 939.0, 995.0, 1042.0, 1097.0, 1153.0, 1208.0, 1269.0, 1330.0,
    1387.0, 1439.0, 1501.0, 1559.0, 1620.0, 1684.0, 1748.0, 1813.0),

    #N2 edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 1.0, 2.0, 3.0, 3.0, 3.0, 3.0, 14.1, 16.3, 21.6, 24.4, 28.5,
    32.6, 37.6, 42.3, 46.3, 50.5, 55.7, 63.7, 63.9, 73.5, 83.6, 95.6,
    103.3, 123.0, 146.7, 172.4, 192.0, 205.8, 223.2, 236.3, 243.3, 242.0,
    265.6, 284.0, 286.0, 322.4, 333.5, 343.5, 366.2, 385.9, 388.7, 412.4,
    438.2, 463.4, 490.4, 518.7, 549.1, 577.8, 609.1, 642.7, 680.2, 720.5,
    761.9, 805.2, 851.0, 886.0, 929.0, 980.0, 1058.0, 1080.0, 1168.0,
    1224.0, 1271.0, 1328.0, 1380.0, 1438.0, 1498.0, 1558.0, 1620.0),

    #N3-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 1.0, 2.0, 3.0, 3.0, 3.0, 3.0, 14.1, 15.3, 20.1, 23.1, 27.1,
    30.8, 35.5, 39.9, 43.2, 47.3, 50.9, 58.3, 63.9, 73.5, 83.6, 95.6,
    103.3, 123.0, 145.5, 161.3, 178.6, 196.0, 206.5, 217.6, 224.6, 242.0,
    247.4, 257.0, 271.0, 284.1, 293.2, 308.2, 320.2, 332.6, 339.7, 359.2,
    380.7, 400.9, 423.6, 446.8, 470.7, 495.8, 519.4, 546.3, 576.6, 609.5,
    643.5, 678.8, 705.0, 740.0, 768.0, 810.0, 879.0, 890.0, 966.4, 1007.0,
    1043.0, 1085.0, 1123.0, 1165.0, 1207.0, 1249.0, 1292.0),

    #N4-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 2.0, 2.0, 4.0, 11.7, 17.7, 24.9, 33.3, 41.9, 50.6, 69.5,
    79.8, 92.6, 105.3, 109.0, 115.1, 120.5, 120.0, 129.0, 133.0, 142.6,
    150.5, 153.6, 160.0, 167.6, 175.5, 191.2, 206.1, 220.0, 237.9, 255.9,
    273.9, 293.1, 311.9, 331.6, 353.2, 378.2, 405.7, 434.3, 464.0, 500.0,
    533.0, 567.0, 603.0, 636.0, 675.0, 712.1, 743.0, 778.3, 816.0, 846.0,
    880.0, 916.0, 955.0, 991.0),

    #N5-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 2.0, 2.0, 4.0, 10.7, 16.9, 23.9, 32.1, 40.4, 48.9, 67.5,
    77.5, 89.9, 102.5, 109.0, 115.1, 120.5, 120.0, 129.0, 127.7, 142.6,
    150.5, 153.6, 160.0, 167.6, 175.5, 182.4, 196.3, 211.5, 226.4, 243.5,
    260.5, 278.5, 296.3, 314.6, 335.1, 358.8, 385.0, 412.2, 440.1, 473.0,
    507.0, 541.0, 577.0, 603.0, 639.0, 675.2, 708.0, 736.2, 771.0, 798.0,
    829.0, 862.0, 898.0, 930.0),

    #N6-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.1, 2.0, 1.5, 4.0, 5.2, 6.0, 8.6, 7.7, 8.0, 8.6, 4.7, 4.6,
    2.5, 8.9, 15.9, 23.5, 33.6, 42.9, 53.4, 63.8, 74.5, 87.6, 104.0, 122.2,
    141.7, 162.3, 184.0, 210.0, 238.0, 268.0, 299.0, 319.0, 342.4, 371.0,
    388.2, 414.0, 436.0, 461.0, 484.0, 511.0, 538.0),

    #N7-edge
    (0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.1, 2.0, 1.5, 4.0, 5.2, 6.0, 8.6, 2.4, 4.3, 5.2, 4.7, 4.6,
    1.3, 7.5, 14.2, 21.6, 31.4, 40.5, 50.7, 60.8, 71.2, 83.9, 99.9, 117.8,
    136.9, 157.0, 184.0, 210.0, 238.0, 268.0, 299.0, 319.0, 333.1, 360.0,
    377.4, 403.0, 424.0, 446.0, 470.0, 495.0, 520.0),

    #K-width
    (0, 0.240, 0.240, 0.240, 0.240, 0.240, 0.240, 0.240, 0.240, 0.240,
    0.240, 0.300, 0.360, 0.420, 0.480, 0.530, 0.590, 0.640, 0.680, 0.740,
    0.810, 0.860, 0.940, 1.010, 1.080, 1.160, 1.250, 1.330, 1.440, 1.550,
    1.670, 1.820, 1.960, 2.140, 2.330, 2.520, 2.750, 2.990, 3.250, 3.520,
    3.840, 4.140, 4.520, 4.910, 5.330, 5.770, 6.240, 6.750, 7.280, 7.910,
    8.490, 9.160, 9.890, 10.600, 11.400, 12.300, 13.200, 14.100, 15.100,
    16.200, 17.300, 18.500, 19.700, 21.000, 22.300, 23.800, 25.200, 26.800,
    28.400, 30.100, 31.900, 33.700, 35.700, 37.700, 39.900, 42.100, 44.400,
    46.800, 49.300, 52.000, 54.600, 57.400, 60.400, 63.400, 66.600, 69.800,
    73.300, 76.800, 80.400, 84.100, 88.000, 91.900, 96.100, 96.100, 96.100,
    96.100, 96.100, 96.100, 96.100 ),

    #L1-width
    (0, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.200, 0.410, 0.730, 1.030, 1.260, 1.490, 1.580, 1.630, 1.920,
    2.070, 2.210, 2.340, 2.410, 2.540, 2.620, 2.760, 2.790, 2.890, 3.060,
    3.280, 3.380, 3.530, 3.790, 3.940, 4.110, 4.280, 4.440, 4.670, 4.710,
    4.780, 3.940, 4.250, 4.360, 4.580, 4.730, 4.930, 4.880, 4.870, 5.000,
    2.970, 3.130, 3.320, 3.460, 3.640, 3.780, 3.920, 4.060, 4.210, 4.340,
    4.520, 4.670, 4.800, 4.910, 5.050, 5.190, 5.250, 5.330, 5.430, 5.470,
    5.530, 5.540, 5.630, 5.580, 5.610, 6.180, 7.250, 8.300, 9.390, 10.500,
    11.300, 12.000, 12.200, 12.400, 12.600, 12.800, 13.100, 13.300, 13.400,
    13.600, 13.700, 14.300, 14.000, 14.000, 14.000, 14.000, 14.000, 14.000,
    14.000),

    #L2-width
    (0, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.000, 0.001, 0.004, 0.015, 0.032, 0.054, 0.083, 0.126, 0.152,
    0.170, 0.190, 0.240, 0.260, 0.290, 0.340, 0.370, 0.430, 0.520, 0.620,
    0.720, 0.830, 0.950, 1.030, 1.130, 1.210, 1.310, 1.430, 1.540, 1.650,
    1.780, 1.870, 1.970, 2.080, 2.230, 2.350, 2.430, 2.570, 2.620, 2.720,
    2.840, 3.000, 3.120, 3.250, 3.400, 3.510, 3.570, 3.680, 3.800, 3.890,
    3.970, 4.060, 4.150, 4.230, 4.320, 4.430, 4.550, 4.660, 4.730, 4.790,
    4.820, 4.920, 5.020, 5.150, 5.330, 5.480, 5.590, 5.690, 5.860, 6.000,
    6.170, 6.320, 6.480, 6.670, 6.830, 7.010, 7.200, 7.470, 7.680, 7.950,
    8.180, 8.750, 9.320, 9.320, 9.320, 9.320, 9.320, 9.320, 9.320 ),

    #L3-width
    (0, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.000, 0.001, 0.004, 0.014, 0.033, 0.054, 0.087, 0.128, 0.156,
    0.170, 0.190, 0.220, 0.240, 0.270, 0.320, 0.360, 0.430, 0.480, 0.560,
    0.650, 0.760, 0.820, 0.940, 1.000, 1.080, 1.170, 1.270, 1.390, 1.500,
    1.570, 1.660, 1.780, 1.910, 2.000, 2.130, 2.250, 2.400, 2.500, 2.650,
    2.750, 2.870, 2.950, 3.080, 3.130, 3.250, 3.320, 3.410, 3.480, 3.600,
    3.650, 3.750, 3.860, 3.910, 4.010, 4.120, 4.170, 4.260, 4.350, 4.480,
    4.600, 4.680, 4.800, 4.880, 4.980, 5.040, 5.160, 5.250, 5.310, 5.410,
    5.500, 5.650, 5.810, 5.980, 6.130, 6.290, 6.410, 6.650, 6.820, 6.980,
    7.130, 7.330, 7.430, 7.430, 7.430, 7.430, 7.430, 7.430, 7.430 ),
    )

#f0 data from cromer-mann
f0data = {
    'h':     [.493002, 10.5109, .322912, 26.1257, .140191, 3.14236, .040810, 57.7997, .003038],
    'h.':    [.489918, 20.6593, .262003, 7.74039, .196767, 49.5519, .049879, 2.20159, .001305],
    'h1-':   [.897661, 53.1368, .565616, 15.1870, .415815, 186.576, .116973, 3.56709, .002389],
    'he':    [0.87340, 9.10370, .6309, 3.3568, .3112, 22.9276, .1780, .9821, .0064],
    'li':    [1.12820, 3.95460, .7508, 1.0524, .6175, 85.3905, .4653, 168.261, .0377],
    'li1+':  [0.69680, 4.62370, .7888, 1.9557, .3414, .6316, .1563, 10.0953, .0167],
    'be':    [1.59190, 43.6427, 1.1278, 1.8623, .5391, 103.483, .7029, .5420, .0385],
    'be2+':  [6.26030, 0.00270, .8849, .8313, .7993, 2.2758, .1647, 5.1146, -6.1092],
    'b':     [2.05450, 23.2185, 1.3326, 1.0210, 1.0979, 60.3498, .7068, .1403, -.1932],
    'c':     [2.31000, 20.8439, 1.0200, 10.2075, 1.5886, .5687, .8650, 51.6512, .2156],
    'c.':    [2.26069, 22.6907, 1.56165, .656665, 1.05075, 9.75618, .839259, 55.5949, .286977],
    'n':     [12.2126, 0.00570, 3.1322, 9.8933, 2.0125, 28.9975, 1.1663, .5826, -11.529],
    'o':     [3.04850, 13.2771, 2.2868, 5.7011, 1.5463, .3239, .8670, 32.9089, .2508],
    'o1-':   [4.19160, 12.8573, 1.63969, 4.17236, 1.52673, 47.0179, -20.307, -.01404, 21.9412],
    'f':     [3.53920, 10.2825, 2.6412, 4.2944, 1.5170, .2615, 1.0243, 26.1476, .2776],
    'f1-':   [3.63220, 5.27756, 3.51057, 14.7353, 1.26064, .442258, .940706, 47.3437, .653396],
    'ne':    [3.95530, 8.40420, 3.1125, 3.4262, 1.4546, .2306, 1.1251, 21.7184, .3515],
    'na':    [4.76260, 3.28500, 3.1736, 8.8422, 1.2674, .3136, 1.1128, 129.424, .6760],
    'na1+':  [3.25650, 2.66710, 3.9362, 6.1153, 1.3998, .2001, 1.0032, 14.0390, .4040],
    'mg':    [5.42040, 2.82750, 2.1735, 79.2611, 1.2269, .3808, 2.3073, 7.1937, .8584],
    'mg2+':  [3.49880, 2.16760, 3.8378, 4.7542, 1.3284, .1850, .8497, 10.1411, .4853],
    'al':    [6.42020, 3.03870, 1.9002, .7426, 1.5936, 31.5472, 1.9646, 85.0886, 1.1151],
    'al3+':  [4.17448, 1.93816, 3.38760, 4.14553, 1.20296, .228753, .528137, 8.28524, .706786],
    'si':    [6.29150, 2.43860, 3.0353, 32.3337, 1.9891, .6785, 1.5410, 81.6937, 1.1407],
    'si.':   [5.66269, 2.66520, 3.07164, 38.6634, 2.62446, .916946, 1.39320, 93.5458, 1.24707],
    'si4+':  [4.43918, 1.64167, 3.20345, 3.43757, 1.19453, .214900, .416530, 6.65365, .746297],
    's':     [6.90530, 1.46790, 5.2034, 22.2151, 1.4379, .2536, 1.5863, 56.1720, .8669],
    'p':     [6.43450, 1.90670, 4.1791, 27.1570, 1.7800, .5260, 1.4908, 68.1645, 1.1149],
    'cl':    [11.4604, 0.01040, 7.1964, 1.1662, 6.2556, 18.5194, 1.6455, 47.7784, -9.5574],
    'cl1-':  [18.2915, 0.00660, 7.2084, 1.1717, 6.5337, 19.5424, 2.3386, 60.4486, -16.378],
    'ar':    [7.48450, 0.90720, 6.7723, 14.8407, .6539, 43.8983, 1.6442, 33.3929, 1.4445],
    'k':     [8.21860, 12.7949, 7.4398, .7748, 1.0519, 213.187, .8659, 41.6841, 1.4228],
    'k1+':   [7.95780, 12.6331, 7.4917, .7674, 6.3590, -.0020, 1.1915, 31.9128, -4.9978],
    'ca':    [8.62660, 10.4421, 7.3873, .6599, 1.5899, 85.7484, 1.0211, 178.437, 1.3751],
    'ca2+':  [15.6348, -.00740, 7.9518, .6089, 8.4372, 10.3116, .8537, 25.9905, -14.875],
    'sc':    [9.18900, 9.02130, 7.3679, .5729, 1.6409, 136.108, 1.4680, 51.3531, 1.3329],
    'sc3+':  [13.4008, .298540, 8.02730, 7.96290, 1.65943, -.28604, 1.57936, 16.0662, -6.6667],
    'ti':    [9.75950, 7.85080, 7.3558, .5000, 1.6991, 35.6338, 1.9021, 116.105, 1.2807],
    'ti2+':  [9.11423, 7.52430, 7.62174, .457585, 2.27930, 19.5361, .087899, 61.6558, .897155],
    'ti3+':  [17.7344, .220610, 8.73816, 7.04716, 5.25691, -.15762, 1.92134, 15.9768, -14.652],
    'ti4+':  [19.5114, .178847, 8.23473, 6.67018, 2.01341, -.29263, 1.52080, 12.9464, -13.280],
    'v':     [10.2971, 6.86570, 7.3511, .4385, 2.0703, 26.8938, 2.0571, 102.478, 1.2199],
    'v2+':   [10.1060, 6.88180, 7.3541, .4409, 2.2884, 20.3004, .0223, 115.122, 1.2298],
    'v3+':   [9.43141, 6.39535, 7.74190, .383349, 2.15343, 15.1908, .016865, 63.9690, .656565],
    'v5+':   [15.6887, .679003, 8.14208, 5.40135, 2.03081, 9.97278, -9.5760, .940464, 1.71430],
    'cr':    [10.6406, 6.10380, 7.3537, .3920, 3.3240, 20.2626, 1.4922, 98.7399, 1.1832],
    'cr2+':  [9.54034, 5.66078, 7.75090, .344261, 3.58274, 13.3075, .509107, 32.4224, .616898],
    'cr3+':  [9.68090, 5.59463, 7.81136, .334393, 2.87603, 12.8288, .113575, 32.8761, .518275],
    'mn':    [11.2819, 5.34090, 7.3573, .3432, 3.0193, 17.8674, 2.2441, 83.7543, 1.0896],
    'mn2+':  [10.8061, 5.27960, 7.3620, .3435, 3.5268, 14.3430, .2184, 41.3235, 1.0874],
    'mn3+':  [9.84521, 4.91797, 7.87194, .294393, 3.56531, 10.8171, .323613, 24.1281, .393974],
    'mn4+':  [9.96253, 4.84850, 7.97057, .283303, 2.76067, 10.4852, .054447, 27.5730, .251877],
    'fe':    [11.7695, 4.76110, 7.3573, .3072, 3.5222, 15.3535, 2.3045, 76.8805, 1.0369],
    'fe2+':  [11.0424, 4.65380, 7.3740, .3053, 4.1346, 12.0546, .4399, 31.2809, 1.0097],
    'fe3+':  [11.1764, 4.61470, 7.3863, .3005, 3.3948, 11.6729, .0724, 38.5566, .9707],
    'co':    [12.2841, 4.27910, 7.3409, .2784, 4.0034, 13.5359, 2.3488, 71.1692, 1.0118],
    'co2+':  [11.2296, 4.12310, 7.3883, .2726, 4.7393, 10.2443, .7108, 25.6466, .9324],
    'co3+':  [10.3380, 3.90969, 7.88173, .238668, 4.76795, 8.35583, .725591, 18.3491, .286667],
    'ni':    [12.8376, 3.87850, 7.2920, .2565, 4.4438, 12.1763, 2.3800, 66.3421, 1.0341],
    'ni2+':  [11.4166, 3.67660, 7.4005, .2449, 5.3442, 8.8730, .9773, 22.1626, .8614],
    'ni3+':  [10.7806, 3.54770, 7.75868, .223140, 5.22746, 7.64468, .847114, 16.9673, .386044],
    'cu':    [13.3380, 3.58280, 7.1676, .2470, 5.6158, 11.3966, 1.6735, 64.8126, 1.1910],
    'cu1+':  [11.9475, 3.36690, 7.3573, .2274, 6.2455, 8.6625, 1.5578, 25.8487, .8900],
    'cu2+':  [11.8168, 3.37484, 7.11181, .244078, 5.78135, 7.98760, 1.14523, 19.8970, 1.14431],
    'zn':    [14.0743, 3.2655, 7.0318, .2333, 5.1652, 10.3163, 2.4100, 58.7097, 1.3041],
    'zn2+':  [11.9719, 2.9946, 7.3862, .2031, 6.4668, 7.0826, 1.3940, 18.0995, .7807],
    'ga':    [15.2354, 3.0669, 6.7006, .2412, 4.3591, 10.7805, 2.9623, 61.4135, 1.7189],
    'ga3+':  [12.6920, 2.81262, 6.69883, .227890, 6.06692, 6.36441, 1.00660, 14.4122, 1.53545],
    'ge':    [16.0816, 2.8509, 6.3747, .2516, 3.7068, 11.4468, 3.6830, 54.7625, 2.1313],
    'ge4+':  [12.9172, 2.53718, 6.70003, .205855, 6.06791, 5.47913, .859041, 11.6030, 1.45572],
    'as':    [16.6723, 2.6345, 6.0701, .2647, 3.4313, 12.9479, 4.2779, 47.7972, 2.5310],
    'se':    [17.0006, 2.4098, 5.8196, .2726, 3.9731, 15.2372, 4.3543, 43.8163, 2.8409],
    'br':    [17.1789, 2.1723, 5.2358, 16.5796, 5.6377, .2609, 3.9851, 41.4328, 2.9557],
    'br1-':  [17.1718, 2.2059, 6.3338, 19.3345, 5.5754, .2871, 3.7272, 58.1535, 3.1776],
    'kr':    [17.3555, 1.9384, 6.7286, 16.5623, 5.5493, .2261, 3.5375, 39.3972, 2.8250],
    'rb':    [17.1784, 1.7888, 9.6435, 17.3151, 5.1399, .2748, 1.5292, 164.934, 3.4873],
    'rb1+':  [17.5816, 1.7139, 7.6598, 14.7957, 5.8981, .1603, 2.7817, 31.2087, 2.0782],
    'sr':    [17.5663, 1.5564, 9.8184, 14.0988, 5.4220, .1664, 2.6694, 132.376, 2.5064],
    'sr2+':  [18.0874, 1.4907, 8.1373, 12.6963, 2.5654, 24.5651, -34.193, -.0138, 41.4025],
    'y':     [17.7760, 1.40290, 10.2946, 12.8006, 5.72629, .125599, 3.26588, 104.354, 1.91213],
    'y3+':   [17.9268, 1.35417, 9.15310, 11.2145, 1.76795, 22.6599, -33.108, -.01319, 40.2602],
    'zr':    [17.8765, 1.27618, 10.9480, 11.9160, 5.41732, .117622, 3.65721, 87.6627, 2.06929],
    'zr4+':  [18.1668, 1.21480, 10.0562, 10.1483, 1.01118, 21.6054, -2.6479, -.10276, 9.41454],
    'nb':    [17.6142, 1.18865, 12.0144, 11.7660, 4.04183, .204785, 3.53346, 69.7957, 3.75591],
    'nb3+':  [19.8812, .019175, 18.0653, 1.13305, 11.0177, 10.1621, 1.94715, 28.3389, -12.912],
    'nb5+':  [17.9163, 1.12446, 13.3417, .028781, 10.7990, 9.28206, .337905, 25.7228, -6.3934],
    'mo':    [3.7025, .2772, 17.2356, 1.0958, 12.8876, 11.0040, 3.7429, 61.6584, 4.3875],
    'mo3+':  [21.1664, .014734, 18.2017, 1.03031, 11.7423, 9.53659, 2.30951, 26.6307, -14.421],
    'mo5+':  [21.0149, .014345, 18.0992, 1.02238, 11.4632, 8.78809, .740625, 23.3452, -14.316],
    'mo6+':  [17.8871, 1.03649, 11.1750, 8.48061, 6.57891, .058881, 0.0, 0.0, .344941],
    'tc':    [19.1301, .864132, 11.0948, 8.14487, 4.64901, 21.5707, 2.71263, 86.8472, 5.40428],
    'ru':    [19.2674, .808520, 12.9182, 8.43467, 4.86337, 24.7997, 1.56756, 94.2928, 5.37874],
    'ru3+':  [18.5638, .847329, 13.2885, 8.37164, 9.32602, .017662, 3.00964, 22.8870, -3.1892],
    'ru4+':  [18.5003, .844582, 13.1787, 8.12534, 4.71304, .036495, 2.18535, 20.8504, 1.42357],
    'rh':    [19.2957, .751536, 14.3501, 8.21758, 4.73425, 25.8749, 1.28918, 98.6062, 5.32800],
    'rh3+':  [18.8785, .764252, 14.1259, 7.84438, 3.32515, 21.2487, -6.1989, -.01036, 11.8678],
    'rh4+':  [18.8545, .760825, 13.9806, 7.62436, 2.53464, 19.3317, -5.6526, -.01020, 11.2835],
    'pd':    [19.3319, .698655, 15.5017, 7.98929, 5.29537, 25.2052, .605844, 76.8986, 5.26593],
    'pd2+':  [19.1701, .696219, 15.2096, 7.55573, 4.32234, 22.5057, 0.0, 0.0, 5.29160],
    'pd4+':  [19.2493, .683839, 14.7900, 7.14833, 2.89289, 17.9144, -7.9492, .005127, 13.0174],
    'ag':    [19.2808, .6446, 16.6885, 7.4726, 4.8045, 24.6605, 1.0463, 99.8156, 5.1790],
    'ag1+':  [19.1812, .646179, 15.9719, 7.19123, 5.27475, 21.7326, .357534, 66.1147, 5.21572],
    'ag2+':  [19.1643, .645643, 16.2456, 7.18544, 4.37090, 21.4072, 0.0, 0.0, 5.21404],
    'cd':    [19.2214, .5946, 17.6444, 6.9089, 4.4610, 24.7008, 1.6029, 87.4825, 5.0694],
    'cd2+':  [19.1514, .597922, 17.2535, 6.80639, 4.47128, 20.2521, 0.0, 0.0, 5.11937],
    'in':    [19.1624, .5476, 18.5596, 6.3776, 4.2948, 25.8499, 2.0396, 92.8029, 4.9391],
    'in3+':  [19.1045, .551522, 18.1108, 6.32470, 3.78897, 17.3595, 0.0, 0.0, 4.99635],
    'sn':    [19.1889, 5.8303, 19.1005, .5031, 4.4585, 26.8909, 2.4663, 83.9571, 4.7821],
    'sn2+':  [19.1094, .5036, 19.0548, 5.8378, 4.5648, 23.3752, .4870, 62.2061, 4.7861],
    'sn4+':  [18.9333, 5.7640, 19.7131, .4655, 3.4182, 14.0049, .0193, -.7583, 3.9182],
    'sb':    [19.6418, 5.3034, 19.0455, .4607, 5.0371, 27.9074, 2.6827, 75.2825, 4.5909],
    'sb3+':  [18.9755, .467196, 18.9330, 5.22126, 5.10789, 19.5902, .288753, 55.5113, 4.69626],
    'sb5+':  [19.8685, 5.44853, 19.0302, .467973, 2.41253, 14.1259, 0.0, 0.0, 4.69263],
    'te':    [19.9644, 4.81742, 19.0138, .420885, 6.14487, 28.5284, 2.52390, 70.8403, 4.35200],
    'i':     [20.1472, 4.3470, 18.9949, .3814, 7.5138, 27.7660, 2.2735, 66.8776, 4.0712],
    'i1-':   [20.2332, 4.3579, 18.9970, .3815, 7.8069, 29.5259, 2.8868, 84.9304, 4.0714],
    'xe':    [20.2933, 3.9282, 19.0298, .3440, 8.9767, 26.4659, 1.9900, 64.2658, 3.7118],
    'cs':    [20.3892, 3.5690, 19.1062, .3107, 10.6620, 24.3879, 1.4953, 213.904, 3.3352],
    'cs1+':  [20.3524, 3.5520, 19.1278, .3086, 10.2821, 23.7128, .9615, 59.4565, 3.2791],
    'ba':    [20.3361, 3.2160, 19.2970, .2756, 10.8880, 20.2073, 2.6959, 167.202, 2.7731],
    'ba2+':  [20.1807, 3.21367, 19.1136, .283310, 10.9054, 20.0558, .773634, 51.7460, 3.02902],
    'la':    [20.5780, 2.94817, 19.5990, .244475, 11.3727, 18.7726, 3.28719, 133.124, 2.14678],
    'la3+':  [20.2489, 2.92070, 19.3763, .250698, 11.6323, 17.8211, .336048, 54.9453, 2.40860],
    'ce':    [21.1671, 2.81219, 19.7695, .226836, 11.8513, 17.6083, 3.33049, 127.113, 1.86264],
    'ce3+':  [20.8036, 2.77691, 19.5590, .231540, 11.9369, 16.5408, .612376, 43.1692, 2.09013],
    'ce4+':  [20.3235, 2.65941, 19.8186, .218850, 12.1233, 15.7992, .144583, 62.2355, 1.59180],
    'pr':    [22.0440, 2.77393, 19.6697, .222087, 12.3856, 16.7669, 2.82428, 143.644, 2.05830],
    'pr3+':  [21.3727, 2.64520, 19.7491, .214299, 12.1329, 15.3230, .975180, 36.4065, 1.77132],
    'pr4+':  [20.9413, 2.54467, 20.0539, .202481, 12.4668, 14.8137, .296689, 45.4643, 1.24285],
    'nd':    [22.6845, 2.66248, 19.6847, .210628, 12.7740, 15.8850, 2.85137, 137.903, 1.98486],
    'nd3+':  [21.9610, 2.52722, 19.9339, .199237, 12.1200, 14.1783, 1.51031, 30.8717, 1.47588],
    'pm':    [23.3405, 2.56270, 19.6095, .202088, 13.1235, 15.1009, 2.87516, 132.721, 2.02876],
    'pm3+':  [22.5527, 2.41740, 20.1108, .185769, 12.0671, 13.1275, 2.07492, 27.4491, 1.19499],
    'sm':    [24.0042, 2.47274, 19.4258, .196451, 13.4396, 14.3996, 2.89604, 128.007, 2.20963],
    'sm3+':  [23.1504, 2.31641, 20.2599, .174081, 11.9202, 12.1571, 2.71488, 24.8242, .954586],
    'eu':    [24.6274, 2.3879, 19.0886, .1942, 13.7603, 13.7546, 2.9227, 123.174, 2.5745],
    'eu2+':  [24.0063, 2.27783, 19.9504, .173530, 11.8034, 11.6096, 3.87243, 26.5156, 1.36389],
    'eu3+':  [23.7497, 2.22258, 20.3745, .163940, 11.8509, 11.3110, 3.26503, 22.9966, .759344],
    'gd':    [25.0709, 2.25341, 19.0798, .181951, 13.8518, 12.9331, 3.54545, 101.398, 2.41960],
    'gd3+':  [24.3466, 2.13553, 20.4208, .155525, 11.8708, 10.5782, 3.71490, 21.7029, .645089],
    'tb':    [25.8976, 2.24256, 18.2185, .196143, 14.3167, 12.6648, 2.95354, 115.362, 3.58324],
    'tb3+':  [24.9559, 2.05601, 20.3271, .149525, 12.2471, 10.0499, 3.77300, 21.2773, .691967],
    'dy':    [26.5070, 2.18020, 17.6383, .202172, 14.5596, 12.1899, 2.96577, 111.874, 4.29728],
    'dy3+':  [25.5395, 1.98040, 20.2861, .143384, 11.9812, 9.34972, 4.50073, 19.5810, .689690],
    'ho':    [26.9049, 2.07051, 17.2940, .197940, 14.5583, 11.4407, 3.63837, 92.6566, 4.56796],
    'ho3+':  [26.1296, 1.91072, 20.0994, .139358, 11.9788, 8.80018, 4.93676, 18.5908, .852795],
    'er':    [27.6563, 2.07356, 16.4285, .223545, 14.9779, 11.3604, 2.98233, 105.703, 5.92046],
    'er3+':  [26.7220, 1.84659, 19.7748, .137290, 12.1506, 8.36225, 5.17379, 17.8974, 1.17613],
    'tm':    [28.1819, 2.02859, 15.8851, .238849, 15.1542, 10.9975, 2.98706, 102.961, 6.75621],
    'tm3+':  [27.3083, 1.78711, 19.3320, .136974, 12.3339, 7.96778, 5.38348, 17.2922, 1.63929],
    'yb':    [28.6641, 1.98890, 15.4345, .257119, 15.3087, 10.6647, 2.98963, 100.417, 7.56672],
    'yb2+':  [28.1209, 1.78503, 17.6817, .159970, 13.3335, 8.18304, 5.14657, 20.3900, 3.70983],
    'yb3+':  [27.8917, 1.73272, 18.7614, .138790, 12.6072, 7.64412, 5.47647, 16.8153, 2.26001],
    'lu':    [28.9476, 1.90182, 15.2208, 9.98519, 15.1000, .261033, 3.71601, 84.3298, 7.97628],
    'lu3+':  [28.4628, 1.68216, 18.1210, .142292, 12.8429, 7.33727, 5.59415, 16.3535, 2.97573],
    'hf':    [29.1440, 1.83262, 15.1726, 9.59990, 14.7586, .275116, 4.30013, 72.0290, 8.58154],
    'hf4+':  [28.8131, 1.59136, 18.4601, .128903, 12.7285, 6.76232, 5.59927, 14.0366, 2.39699],
    'ta':    [29.2024, 1.77333, 15.2293, 9.37046, 14.5135, .295977, 4.76492, 63.3644, 9.24354],
    'ta5+':  [29.1587, 1.50711, 18.8407, .116741, 12.8268, 6.31524, 5.38695, 12.4244, 1.78555],
    'w':     [29.0818, 1.72029, 15.4300, 9.22590, 14.4327, .321703, 5.11982, 57.0560, 9.88750],
    'w6+':   [29.4936, 1.42755, 19.3763, .104621, 13.0544, 5.93667, 5.06412, 11.1972, 1.01074],
    're':    [28.7621, 1.67191, 15.7189, 9.09227, 14.5564, .350500, 5.44174, 52.0861, 10.4720],
    'os':    [28.1894, 1.62903, 16.1550, 8.97948, 14.9305, .382661, 5.67589, 48.1647, 11.0005],
    'os4+':  [30.4190, 1.37113, 15.2637, 6.84706, 14.7458, .165191, 5.06795, 18.0030, 6.49804],
    'ir':    [27.3049, 1.59279, 16.7296, 8.86553, 15.6115, .417916, 5.83377, 45.0011, 11.4722],
    'ir3+':  [30.4156, 1.34323, 15.8620, 7.10909, 13.6145, .204633, 5.82008, 20.3254, 8.27903],
    'ir4+':  [30.7058, 1.30923, 15.5512, 6.71983, 14.2326, .167252, 5.53672, 17.4911, 6.96824],
    'pt':    [27.0059, 1.51293, 17.7639, 8.81174, 15.7131, .424593, 5.78370, 38.6103, 11.6883],
    'pt2+':  [29.8429, 1.32927, 16.7224, 7.38979, 13.2153, .263297, 6.35234, 22.9426, 9.85329],
    'pt4+':  [30.9612, 1.24813, 15.9829, 6.60834, 13.7348, .168640, 5.92034, 16.9392, 7.39534],
    'au':    [16.8819, .4611, 18.5913, 8.6216, 25.5582, 1.4826, 5.8600, 36.3956, 12.0658],
    'au1+':  [28.0109, 1.35321, 17.8204, 7.73950, 14.3359, .356752, 6.58077, 26.4043, 11.2299],
    'au3+':  [30.6886, 1.21990, 16.9029, 6.82872, 12.7801, .212867, 6.52354, 18.6590, 9.09680],
    'hg':    [20.6809, .5450, 19.0417, 8.4484, 21.6575, 1.5729, 5.9676, 38.3246, 12.6089],
    'hg1+':  [25.0853, 1.39507, 18.4973, 7.65105, 16.8883, .443378, 6.48216, 28.2262, 12.0205],
    'hg2+':  [29.5641, 1.21152, 18.0600, 7.05639, 12.8374, .284738, 6.89912, 20.7482, 10.6268],
    'tl':    [27.5446, .655150, 19.1584, 8.70751, 15.5380, 1.96347, 5.52593, 45.8149, 13.1746],
    'tl1+':  [21.3985, 1.47110, 20.4723, .517394, 18.7478, 7.43463, 6.82847, 28.8482, 12.5258],
    'tl3+':  [30.8695, 1.10080, 18.3841, 6.53852, 11.9328, .219074, 7.00574, 17.2114, 9.80270],
    'pb':    [31.0617, .6902, 13.0637, 2.3576, 18.4420, 8.6180, 5.9696, 47.2579, 13.4118],
    'pb2+':  [21.7886, 1.33660, 19.5682, .488383, 19.1406, 6.77270, 7.01107, 23.8132, 12.4734],
    'pb4+':  [32.1244, 1.00566, 18.8003, 6.10926, 12.0175, .147041, 6.96886, 14.7140, 8.08428],
    'bi':    [33.3689, .7040, 12.9510, 2.9238, 16.5877, 8.7937, 6.4692, 48.0093, 13.5782],
    'bi3+':  [21.8053, 1.23560, 19.5026, 6.24149, 19.1053, .469999, 7.10295, 20.3185, 12.4711],
    'bi5+':  [33.5364, .916540, 25.0946, .039042, 19.2497, 5.71414, 6.91555, 12.8285, -6.7994],
    'po':    [34.6726, .700999, 15.4733, 3.55078, 13.1138, 9.55642, 7.02588, 47.0045, 13.6770],
    'at':    [35.3163, .685870, 19.0211, 3.97458, 9.49887, 11.3824, 7.42518, 45.4715, 13.7108],
    'rn':    [35.5631, .6631, 21.2816, 4.0691, 8.0037, 14.0422, 7.4433, 44.2473, 13.6905],
    'fr':    [35.9299, .646453, 23.0547, 4.17619, 12.1439, 23.1052, 2.11253, 150.645, 13.7247],
    'ra':    [35.7630, .616341, 22.9064, 3.87135, 12.4739, 19.9887, 3.21097, 142.325, 13.6211],
    'ra2+':  [35.2150, .604909, 21.6700, 3.57670, 7.91342, 12.6010, 7.65078, 29.8436, 13.5431],
    'ac':    [35.6597, .589092, 23.1032, 3.65155, 12.5977, 18.5990, 4.08655, 117.020, 13.5266],
    'ac3+':  [35.1736, .579689, 22.1112, 3.41437, 8.19216, 12.9187, 7.05545, 25.9443, 13.4637],
    'th':    [35.5645, .563359, 23.4219, 3.46204, 12.7473, 17.8309, 4.80703, 99.1722, 13.4314],
    'th4+':  [35.1007, .555054, 22.4418, 3.24498, 9.78554, 13.4661, 5.29444, 23.9533, 13.3760],
    'pa':    [35.8847, .547751, 23.2948, 3.41519, 14.1891, 16.9235, 4.17287, 105.251, 13.4287],
    'u':     [36.0228, .5293, 23.4128, 3.3253, 14.9491, 16.0927, 4.1880, 100.613, 13.3966],
    'u3+':   [35.5747, .520480, 22.5259, 3.12293, 12.2165, 12.7148, 5.37073, 26.3394, 13.3092],
    'u4+':   [35.3715, .516598, 22.5326, 3.05053, 12.0291, 12.5723, 4.79840, 23.4582, 13.2671],
    'u6+':   [34.8509, .507079, 22.7584, 2.89030, 14.0099, 13.1767, 1.21457, 25.2017, 13.1665],
    'np':    [36.1874, .511929, 23.5964, 3.25396, 15.6402, 15.3622, 4.18550, 97.4908, 13.3573],
    'np3+':  [35.0136, .489810, 22.7286, 2.81099, 14.3884, 12.3300, 1.75669, 22.6581, 13.1130],
    'np4+':  [36.5254, .499384, 23.8083, 3.26371, 16.7707, 14.9455, 3.47947, 105.980, 13.3812],
    'np6+':  [35.7074, .502322, 22.6130, 3.03807, 12.9898, 12.1449, 5.43227, 25.4928, 13.2544],
    'pu':    [35.5103, .498626, 22.5787, 2.96627, 12.7766, 11.9484, 4.92159, 22.7502, 13.2116],
    'pu3+':  [35.8400, .484938, 22.7169, 2.96118, 13.5807, 11.5331, 5.66016, 24.3992, 13.1991],
    'pu4+':  [35.6493, .481422, 22.6460, 2.89020, 13.3595, 11.3160, 5.18831, 21.8301, 13.1555],
    'pu6+':  [35.1736, .473204, 22.7181, 2.73848, 14.7635, 11.5530, 2.28678, 20.9303, 13.0582],
    'am':    [36.6706, .483629, 24.0992, 3.20647, 17.3415, 14.3136, 3.49331, 102.273, 13.3592],
    'cm':    [36.6488, .465154, 24.4096, 3.08997, 17.3990, 13.4346, 4.21665, 88.4834, 13.2887],
    'bk':    [36.7881, .451018, 24.7736, 3.04619, 17.8919, 12.8946, 4.23284, 86.0030, 13.2754],
    'cf':    [36.9185, 0.437533, 25.1995, 3.00775, 18.3317, 12.4044, 4.24391, 83.7881, 13.2674],
    'o2-.':  [4.758, 7.831, 3.637, 30.05, 0., 0., 0., 0., 1.594],
    '':      [0., 0., 0., 0., 0., 0., 0., 0., 1. ]}

##########################################################################
def z(sym):
    "atomic z from symbol"
    s = "%s%s  " % (sym[0:1].upper(),sym[1:])
    s = s[0:2]
    if (s not in _at_dat[SYMBOL]): s = None
    return list(_at_dat[SYMBOL]).index(s)

def data(z,TABLE):
    "general interface to atomic data tables"
    if (z>98 or z<1): z = 0
    return _at_dat[TABLE][z]

def symbol(z):
    "atomic symbol from z"
    return data(z,SYMBOL)

def atomc_weight(z):
    "atomic weight from atom number (z), amu"
    return data(z,WEIGHT)

def kwidth(z):
    "K core-level width  eV"
    return data(z,KWIDTH)

def l1width(z):
    "L1 core-level width  eV"
    return data(z,L1WIDTH)

def l2width(z):
    "L2 core-level width  eV"
    return data(z,L2WIDTH)

def l3width(z):
    "L3 core-level width  eV"
    return data(z,L3WIDTH)

def kedge(z):
    "K edge energy atom number (z). eV"
    return data(z,KEDGE)

def l1edge(z):
    "L1 edge energy atom number (z). eV"
    return data(z,L1EDGE)

def l2edge(z):
    "L2 edge energy atom number (z). eV"
    return data(z,L2EDGE)

def l3edge(z):
    "L3 edge energy atom number (z). eV"
    return data(z,L3EDGE)

def m1edge(z):
    "M1 edge energy atom number (z). eV"
    return data(z,M1EDGE)

def m2edge(z):
    "M2 edge energy atom number (z). eV"
    return data(z,M2EDGE)

def m3edge(z):
    "M3 edge energy atom number (z). eV"
    return data(z,M3EDGE)

def m4edge(z):
    "M4 edge energy atom number (z). eV"
    return data(z,M4EDGE)

def m5edge(z):
    "M5 edge energy atom number (z). eV"
    return data(z,M5EDGE)

def n1edge(z):
    "N1 edge energy atom number (z). eV"
    return data(z,N1EDGE)

def n2edge(z):
    "N2 edge energy atom number (z). eV"
    return data(z,N2EDGE)

def n3edge(z):
    "N3 edge energy atom number (z). eV"
    return data(z,N3EDGE)

def n4edge(z):
    "N4 edge energy atom number (z). eV"
    return data(z,N4EDGE)

def n5edge(z):
    "N5 edge energy atom number (z). eV"
    return data(z,N5EDGE)

def n6edge(z):
    "N4 edge energy atom number (z). eV"
    return data(z,N6EDGE)

def n7edge(z):
    "N5 edge energy atom number (z). eV"
    return data(z,N7EDGE)

def fluor_line(z,line):
    " return energy of fluorescence line"
    lt = line.lower()
    x,y  = (-1.,-1.)
    if (lt[0:1] == 'k'):
        x = kedge(z)
    elif (lt[0:1] == 'l'):
        x = l3edge(z)

    if (lt == 'kalpha'    or  lt == 'kalpha1'):
        y = l3edge(z)
    elif (lt == 'kbeta'   or  lt == 'kbeta1'):
        y = m3edge(z)
    elif (lt == 'kalpha2'):
        y = l2edge(z)
    elif (lt == 'kalpha3'):
        y = l1edge(z)
    elif (lt == 'kbeta2'):
        y = n3edge(z)
    elif (lt == 'kbeta3'):
        y = m2edge(z)
    elif (lt == 'kbeta4'):
        y = n4edge(z)
    elif (lt == 'kbeta5'):
        y = m4edge(z)
    elif (lt == 'lalpha'  or  lt == 'lalpha1'):
        y = m5edge(z)
    elif (lt == 'lbeta'   or  lt == 'lbeta1'):
        x = l2edge(z)
        y = m4edge(z)
    elif (lt == 'lgamma'  or  lt == 'lgamma1'):
        x = l2edge(z)
        y = n4edge(z)
    elif (lt == 'lalpha2'):
        y = m4edge(z)
    elif (lt == 'lbeta2'):
        y = n4edge(z)
    elif (lt == 'lbeta3'):
        x = l1edge(z)
        y = m3edge(z)
    elif (lt == 'lbeta4'):
        x = l1edge(z)
        y = m2edge(z)
    elif (lt == 'lbeta6'):
        y = n1edge(z)
    elif (lt == 'lgamma2'):
        x = l1edge(z)
        y = n2edge(z)
    elif (lt == 'lgamma3'):
        x = l1edge(z)
        y = n3edge(z)
    if (x>0 and y>0):   return x - y
    return 0

def f0_cromer(elem, q):
    """
  calculate f0 from cromer-mann-libermann tables of coefficients

  arguments:
    elem  symbol for element and valence
    q     sin(theta)/lambda , either single value or list of values
  returns
    f0cromm: value of f0 for element 

  algorithm: Aikmann(?) polynomial with 9 coefficients 
                        4
     f0_j(qmom) = cj + sum [ aij*exp(-bij*qmom^2) ]
                       i=1                           
     where j specifies the element/valence
  notes:
    1.  if (ielv.ne.0), it will be used without looking at elv. 
        this speeds up repeated calls for the same element, but
        will require some bookkeeping
    2.  momentum transfer would really be  (lambda*qmom / 2*pi)
    3.  values for a,b,and c are stored in array a(1..9)  
        in thic order: (a1,b1,a2,b2,a3,b3,a4,b4,c)
        """
    # determine element index from symbol
    el = elem.lower()
    if el in f0data.keys():
        dat = f0data[el]
    else:
        print " element " , elem, " not found in tables."
        return -1
    
    #  make sure q is a numeric array
    if (type(q) in (types.IntType, types.FloatType)):  q = [q]
    if (type(q) == types.ListType):  q = num.array(q)
    
    f0 = num.ones(len(q)) * dat[8]
    q2= -q*q
    for i in range(4):
        f0  = f0 + dat[2*i] * num.exp(dat[1+2*i]*q2)

    if  (len(q) == 1):  f0 = f0[0]
    return f0
        
##########################################################################
if (__name__ == '__main__'):
    z = 28
    print z, symbol(z)
    print 'K edge  ', kedge(z), ' L3 edge ', l3edge(z)
    print 'K alpha1', fluor_line(z,'kalpha1')
    print 'K alpha2', fluor_line(z,'kalpha2')
    print 'K alpha3', fluor_line(z,'kalpha3')
    print 'K beta1 ', fluor_line(z,'kbeta1')
    print 'K beta2 ', fluor_line(z,'kbeta2')
    print 'K beta3 ', fluor_line(z,'kbeta3')    

    q = []
    for i in range(10): q.append(i/2.)
    r = f0_cromer('ni', q)
    print 'Cromer-Mann F0(q): '
    print '------------------------'
    print '       q         f0'
    for i in range(len(q)):
        print  "%10.2f  %11.5f" % (q[i], r[i])

